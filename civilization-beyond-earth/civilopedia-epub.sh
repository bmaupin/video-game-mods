# Create an epub from the Civilopedia content from the game
#
# Since the Civilopedia content has already been converted to HTML and uploaded to
# fandom.com, get it from there.

# Prerequisites:
# - Percollate (https://github.com/danburzo/percollate)
# - unzip
# - zip

# Going over the Civilopedia content, this seems to be the most interesting:
#
# - Sponsors
# - Leaders
# - Resources (https://civilization.fandom.com/wiki/Resources_(CivBE))
# - Aliens (https://civilization.fandom.com/wiki/List_of_Aliens_in_CivBE)
# - Wonders (https://civilization.fandom.com/wiki/Wonders_(CivBE))
# - Buildings
# - Units

epub_filename="Beyond Earth - base game.epub"

# For now, just include articles from the base game. Later we can add the Rising Tide content to it or separately.
percollate epub --inline -o "${epub_filename}" -t "Beyond Earth" 'https://civilization.fandom.com/wiki/American_Reclamation_Corporation_(CivBE)' 'https://civilization.fandom.com/wiki/Suzanne_Fielding_(CivBE)' 'https://civilization.fandom.com/wiki/Pan-Asian_Cooperative_(CivBE)' 'https://civilization.fandom.com/wiki/Daoming_Sochua_(CivBE)' 'https://civilization.fandom.com/wiki/People%27s_African_Union_(CivBE)' 'https://civilization.fandom.com/wiki/Samatar_Jama_Barre_(CivBE)' 'https://civilization.fandom.com/wiki/Kavithan_Protectorate_(CivBE)' 'https://civilization.fandom.com/wiki/Kavitha_Thakur_(CivBE)' 'https://civilization.fandom.com/wiki/Brasilia_(CivBE)' 'https://civilization.fandom.com/wiki/Rejinaldo_Bolivar_De_Alencar-Araripe_(CivBE)' 'https://civilization.fandom.com/wiki/Franco-Iberia_(CivBE)' 'https://civilization.fandom.com/wiki/%C3%89lodie_(CivBE)' 'https://civilization.fandom.com/wiki/Polystralia_(CivBE)' 'https://civilization.fandom.com/wiki/Hutama_(CivBE)' 'https://civilization.fandom.com/wiki/Slavic_Federation_(CivBE)' 'https://civilization.fandom.com/wiki/Vadim_Kozlov_(CivBE)' 'https://civilization.fandom.com/wiki/Wolf_beetle_(CivBE)' 'https://civilization.fandom.com/wiki/Raptor_bug_(CivBE)' 'https://civilization.fandom.com/wiki/Siege_worm_(CivBE)' 'https://civilization.fandom.com/wiki/Drone_(CivBE)' 'https://civilization.fandom.com/wiki/Manticore_(CivBE)' 'https://civilization.fandom.com/wiki/Sea_Dragon_(CivBE)' 'https://civilization.fandom.com/wiki/Kraken_(CivBE)' 'https://civilization.fandom.com/wiki/Headquarters_(CivBE)' 'https://civilization.fandom.com/wiki/Spy_Agency_(CivBE)' 'https://civilization.fandom.com/wiki/Culper_Lodge_(CivBE)' 'https://civilization.fandom.com/wiki/Ansible_(CivBE)' 'https://civilization.fandom.com/wiki/Archimedes_Lever_(CivBE)' 'https://civilization.fandom.com/wiki/Armasail_(CivBE)' 'https://civilization.fandom.com/wiki/Bytegeist_(CivBE)' 'https://civilization.fandom.com/wiki/Crawler_(CivBE)' 'https://civilization.fandom.com/wiki/Cynosure_(CivBE)' 'https://civilization.fandom.com/wiki/Daedalus_Ladder_(CivBE)' 'https://civilization.fandom.com/wiki/Deep_Memory_(CivBE)' 'https://civilization.fandom.com/wiki/Drone_Sphere_(CivBE)' 'https://civilization.fandom.com/wiki/Ectogenesis_Pod_(CivBE)' 'https://civilization.fandom.com/wiki/Gene_Vault_(CivBE)' 'https://civilization.fandom.com/wiki/Holon_Chamber_(CivBE)' 'https://civilization.fandom.com/wiki/Human_Hive_(CivBE)' 'https://civilization.fandom.com/wiki/Markov_Eclipse_(CivBE)' 'https://civilization.fandom.com/wiki/Mass_Driver_(CivBE)' 'https://civilization.fandom.com/wiki/Master_Control_(CivBE)' 'https://civilization.fandom.com/wiki/Memetwork_(CivBE)' 'https://civilization.fandom.com/wiki/Nanothermite_(CivBE)' 'https://civilization.fandom.com/wiki/New_Terran_Myth_(CivBE)' 'https://civilization.fandom.com/wiki/Panopticon_(CivBE)' 'https://civilization.fandom.com/wiki/Precog_Project_(CivBE)' 'https://civilization.fandom.com/wiki/Promethean_(CivBE)' 'https://civilization.fandom.com/wiki/Quantum_Computer_(CivBE)' 'https://civilization.fandom.com/wiki/Resurrection_Device_(CivBE)' 'https://civilization.fandom.com/wiki/Stellar_Codex_(CivBE)' 'https://civilization.fandom.com/wiki/Tectonic_Anvil_(CivBE)' 'https://civilization.fandom.com/wiki/Xenodrome_(CivBE)' 'https://civilization.fandom.com/wiki/Xenomalleum_(CivBE)' 'https://civilization.fandom.com/wiki/Xenonova_(CivBE)' 'https://civilization.fandom.com/wiki/Emancipation_Gate_(CivBE)' 'https://civilization.fandom.com/wiki/Exodus_Gate_(CivBE)' 'https://civilization.fandom.com/wiki/Mind_Flower_(CivBE)' 'https://civilization.fandom.com/wiki/Transcendental_Equation_(CivBE)' 'https://civilization.fandom.com/wiki/Decode_Signal_(CivBE)' 'https://civilization.fandom.com/wiki/Beacon_(CivBE)' 'https://civilization.fandom.com//wiki/Old_Earth_Relic_(CivBE)' 'https://civilization.fandom.com//wiki/Alien_Preserve_(CivBE)' 'https://civilization.fandom.com//wiki/Feedsite_Hub_(CivBE)' 'https://civilization.fandom.com//wiki/Holosuite_(CivBE)' 'https://civilization.fandom.com//wiki/CEL_Cradle_(CivBE)' 'https://civilization.fandom.com//wiki/Xeno_Sanctuary_(CivBE)' 'https://civilization.fandom.com//wiki/Terra_Vault_(CivBE)' 'https://civilization.fandom.com//wiki/Thorium_Reactor_(CivBE)' 'https://civilization.fandom.com//wiki/Xenofuel_Plant_(CivBE)' 'https://civilization.fandom.com//wiki/Biofuel_Plant_(CivBE)' 'https://civilization.fandom.com//wiki/Gaian_Well_(CivBE)' 'https://civilization.fandom.com//wiki/Field_Reactor_(CivBE)' 'https://civilization.fandom.com//wiki/Vivarium_(CivBE)' 'https://civilization.fandom.com//wiki/Cloning_Plant_(CivBE)' 'https://civilization.fandom.com//wiki/Mass_Digester_(CivBE)' 'https://civilization.fandom.com//wiki/Growlab_(CivBE)' 'https://civilization.fandom.com//wiki/Molecular_Forge_(CivBE)' 'https://civilization.fandom.com//wiki/Nanopasture_(CivBE)' 'https://civilization.fandom.com//wiki/Civil_Cr%C3%A8che_(CivBE)' 'https://civilization.fandom.com//wiki/Clinic_(CivBE)' 'https://civilization.fandom.com//wiki/Cytonursery_(CivBE)' 'https://civilization.fandom.com//wiki/Pharmalab_(CivBE)' 'https://civilization.fandom.com//wiki/Gene_Garden_(CivBE)' 'https://civilization.fandom.com//wiki/Bionics_Lab_(CivBE)' 'https://civilization.fandom.com//wiki/Gene_Smelter_(CivBE)' 'https://civilization.fandom.com//wiki/Optical_Surgery_(CivBE)' 'https://civilization.fandom.com//wiki/Soma_Distillery_(CivBE)' 'https://civilization.fandom.com//wiki/Progenitor_Garden_(CivBE)' 'https://civilization.fandom.com//wiki/Laboratory_(CivBE)' 'https://civilization.fandom.com//wiki/Observatory_(CivBE)' 'https://civilization.fandom.com//wiki/Xenonursery_(CivBE)' 'https://civilization.fandom.com//wiki/Network_(CivBE)' 'https://civilization.fandom.com//wiki/Neurolab_(CivBE)' 'https://civilization.fandom.com//wiki/Institute_(CivBE)' 'https://civilization.fandom.com//wiki/Organ_Printer_(CivBE)' 'https://civilization.fandom.com//wiki/Mantle_(CivBE)' 'https://civilization.fandom.com//wiki/Hypercore_(CivBE)' 'https://civilization.fandom.com//wiki/Trade_Depot_(CivBE)' 'https://civilization.fandom.com//wiki/Recycler_(CivBE)' 'https://civilization.fandom.com//wiki/Autoplant_(CivBE)' 'https://civilization.fandom.com//wiki/Biofactory_(CivBE)' 'https://civilization.fandom.com//wiki/Alloy_Foundry_(CivBE)' 'https://civilization.fandom.com//wiki/Repair_Facility_(CivBE)' 'https://civilization.fandom.com//wiki/LEV_Plant_(CivBE)' 'https://civilization.fandom.com//wiki/Microbial_Mine_(CivBE)' 'https://civilization.fandom.com//wiki/Borehole_(CivBE)' 'https://civilization.fandom.com//wiki/Bioglass_Furnace_(CivBE)' 'https://civilization.fandom.com//wiki/Skycrane_(CivBE)' 'https://civilization.fandom.com//wiki/Ultrasonic_Fence_(CivBE)' 'https://civilization.fandom.com//wiki/Rocket_Battery_(CivBE)' 'https://civilization.fandom.com//wiki/Defense_Perimeter_(CivBE)' 'https://civilization.fandom.com//wiki/Surveillance_Web_(CivBE)' 'https://civilization.fandom.com//wiki/Command_Center_(CivBE)' 'https://civilization.fandom.com//wiki/Node_Bank_(CivBE)' 'https://civilization.fandom.com//wiki/Augmentery_(CivBE)' 'https://civilization.fandom.com//wiki/Launch_Complex_(CivBE)' 'https://civilization.fandom.com//wiki/Mind_Stem_(CivBE)' 'https://civilization.fandom.com//wiki/Neoplanetarium_(CivBE)' 'https://civilization.fandom.com//wiki/Petrochemical_Plant_(CivBE)' 'https://civilization.fandom.com//wiki/Water_Refinery_(CivBE)' 'https://civilization.fandom.com//wiki/Colonist_(CivBE)' 'https://civilization.fandom.com//wiki/Worker_(CivBE)' 'https://civilization.fandom.com//wiki/Trade_Convoy_(CivBE)' 'https://civilization.fandom.com//wiki/Trade_Vessel_(CivBE)' 'https://civilization.fandom.com//wiki/Earthling_Settler_(CivBE)' 'https://civilization.fandom.com//wiki/Ultrasonic_Emitter_(CivBE)' 'https://civilization.fandom.com//wiki/Explorer_(CivBE)' 'https://civilization.fandom.com//wiki/Soldier_(CivBE)' 'https://civilization.fandom.com//wiki/Ranger_(CivBE)' 'https://civilization.fandom.com//wiki/Combat_Rover_(CivBE)' 'https://civilization.fandom.com//wiki/Missile_Rover_(CivBE)' 'https://civilization.fandom.com//wiki/Gunboat_(CivBE)' 'https://civilization.fandom.com//wiki/Carrier_(CivBE)' 'https://civilization.fandom.com//wiki/Tacjet_(CivBE)' 'https://civilization.fandom.com//wiki/Xeno_Swarm_(CivBE)' 'https://civilization.fandom.com//wiki/Xeno_Cavalry_(CivBE)' 'https://civilization.fandom.com//wiki/Rocktopus_(CivBE)' 'https://civilization.fandom.com//wiki/Xeno_Titan_(CivBE)' 'https://civilization.fandom.com//wiki/Battlesuit_(CivBE)' 'https://civilization.fandom.com//wiki/Aegis_(CivBE)' 'https://civilization.fandom.com//wiki/LEV_Tank_(CivBE)' 'https://civilization.fandom.com//wiki/LEV_Destroyer_(CivBE)' 'https://civilization.fandom.com//wiki/CNDR_(CivBE)' 'https://civilization.fandom.com//wiki/CARVR_(CivBE)' 'https://civilization.fandom.com//wiki/SABR_(CivBE)' 'https://civilization.fandom.com//wiki/ANGEL_(CivBE)' 'https://civilization.fandom.com//wiki/All-Seer_(CivBE)' 'https://civilization.fandom.com//wiki/Deep_Space_Telescope_(CivBE)' 'https://civilization.fandom.com//wiki/Holomatrix_(CivBE)' 'https://civilization.fandom.com//wiki/Lasercom_Satellite_(CivBE)' 'https://civilization.fandom.com//wiki/Miasmic_Condenser_(CivBE)' 'https://civilization.fandom.com//wiki/Miasmic_Repulsor_(CivBE)' 'https://civilization.fandom.com//wiki/Orbital_Fabricator_(CivBE)' 'https://civilization.fandom.com//wiki/Orbital_Laser_(CivBE)' 'https://civilization.fandom.com//wiki/Phasal_Transporter_(CivBE)' 'https://civilization.fandom.com//wiki/Planet_Carver_(CivBE)' 'https://civilization.fandom.com//wiki/Rocktopus_(CivBE)' 'https://civilization.fandom.com//wiki/Solar_Collector_(CivBE)' 'https://civilization.fandom.com//wiki/Tacnet_Hub_(CivBE)' 'https://civilization.fandom.com//wiki/Weather_Controller_(CivBE)' 'https://civilization.fandom.com/wiki/Xenomass_(CivBE)' 'https://civilization.fandom.com/wiki/Floatstone_(CivBE)' 'https://civilization.fandom.com/wiki/Firaxite_(CivBE)' 'https://civilization.fandom.com/wiki/Titanium_(CivBE)' 'https://civilization.fandom.com/wiki/Geothermal_(CivBE)' 'https://civilization.fandom.com/wiki/Petroleum_(CivBE)' 'https://civilization.fandom.com/wiki/Algae_(CivBE)' 'https://civilization.fandom.com/wiki/Basalt_(CivBE)' 'https://civilization.fandom.com/wiki/Chitin_(CivBE)' 'https://civilization.fandom.com/wiki/Copper_(CivBE)' 'https://civilization.fandom.com/wiki/Coral_(CivBE)' 'https://civilization.fandom.com/wiki/Fiber_(CivBE)' 'https://civilization.fandom.com/wiki/Fruit_(CivBE)' 'https://civilization.fandom.com/wiki/Fungus_(CivBE)' 'https://civilization.fandom.com/wiki/Gold_(CivBE)' 'https://civilization.fandom.com/wiki/Resilin_(CivBE)' 'https://civilization.fandom.com/wiki/Silica_(CivBE)' 'https://civilization.fandom.com/wiki/Tubers_(CivBE)'

# NOTE: --inline currently doesn't work due to this bug: https://github.com/danburzo/percollate/issues/159

# Work around bug https://github.com/danburzo/percollate/issues/169
unzip "${epub_filename}" -d tmp-epub
mv "${epub_filename}" "${epub_filename}.bak"
cd tmp-epub
zip -X ../"${epub_filename}" mimetype
zip -rX ../"${epub_filename}" * -x mimetype
cd ..
rm -rf tmp-epub

# Other notes:
# - Pandoc was originally used but it preserves too much of the original formatting and the resulting EPUB is too cluttered and messy